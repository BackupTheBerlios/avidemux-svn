SET(ADM_core_SRCS 
        ADM_cpuCap.cpp  ADM_memcpy.cpp  ADM_memsupport.cpp  ADM_threads.cpp  ADM_win32.cpp
        ADM_memory.cpp  ADM_misc.cpp  TLK_clock.cpp  ADM_crashdump.cpp  ADM_fileio.cpp ADM_dynamicLoading.cpp)

ADD_LIBRARY(ADM_core SHARED ${ADM_core_SRCS})
ADD_TARGET_DEFINITIONS(ADM_core ADM_DEBUG FIND_LEAKS)

IF (MINGW)
        ADD_SOURCE_CFLAGS(ADM_fileio.cpp ${GLIB_CFLAGS})

        ADD_TARGET_LDFLAGS(ADM_core ${GLIB_LDFLAGS})
        TARGET_LINK_LIBRARIES(ADM_core pthreadGC2 imagehlp wsock32)
ENDIF (MINGW)

REMOVE_DEFINITIONS(-DHAVE_CONFIG_H)

INSTALL(TARGETS ADM_core RUNTIME DESTINATION ${BIN_DIR} LIBRARY DESTINATION lib)
