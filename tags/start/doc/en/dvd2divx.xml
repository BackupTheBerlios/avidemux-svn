<?xml version='1.0' encoding="UTF-8"?>
<guide >
<title>Mpeg to Divx tutorial</title>
<author title="mean"><mail link="fixounet@free.fr">
Mean</mail>
</author>

<abstract>
Mpeg to Divx
 </abstract>

<version>1.0</version>
<date>08 Feb 2003</date>
<chapter>
<title>Getting ready</title>
<body>
This page is an example of encoding mpeg1 or 2 ( a DVD 
for example) into AVI, with xvid and mp3 audio.
</body>
<section>
<title>Input stream</title>
<body>
<p>
 Only mpeg video (m1v and m2v) and mpeg program stream are supported by avidemux 
(mpg/vob).
 The stream must be mono angle, and not cyphered. Let's call this stream
stream.mpg
</p>
<p>
 If your source is a dvd, a good way is to use the very reliable Mplayer like this :
 <c>mplayer -dvd 1 -dumpstream</c>.
 It will create a avidemux compatible vob from the DVD.
</p>
<p>
	VDR files are currently unsupported.
</p>
</body>
</section>
<section>
<title>Indexing</title>
<body>
<p>
Avidemux cannot read mpeg stream. Rather it can read mpeg stream index.
</p>
<p>
A mpeg stream index is a plain text file describing the mpeg and where the frames are located. It is very similar to the d2v structure of DVD2AVI, a great windows frame server.
</p>
<p>It is this index that allows avidemux to random seek in the file and to be frame accurate.
</p>
<p>
To build this index, you have two options :
<ul>
<li>Go to <c>misc->index mpeg</c></li>
<li>Open the mpeg, avidemux will propose to index it(note that the opening will fail, it is normal)</li>
</ul>
You will get to this screen : 
</p>
<p><img src="../image_tuto/mpegindex.png"></img>
</p>
<p>
The index and mpeg fields are obvious.
</p>
<p>
For the audio track, the simplest is to press the <c>Scan file for audio stream</c> and wait a few seconds.
The pulldown menus will be filled by detected audio streams and their features (bitrate etc...).
</p>
<p>Press <c>Ok</c>, and wait a few minutes, the index is being created. When done, we are ready to play with the mpeg stream.
</p>
</body>
</section>
</chapter>
<chapter>
	<title>Editing the video</title>
<section>
	<title>NSTC versus Film</title>
	<body><ul>
		<p>
			Some DVD are coded as 23.976 aka FILM (most movies actually). Some others are coded as 29.97 (NSTC), soap for example. In the first case, the DVD player does a operation to convert it on the fly to NSTC format (telecine). So the mpeg header always says 29.96 as it will always be the final format.	
		</p>
		<p>Avidemux uses mpeg2dec to decode mpeg streams (with a little patch). Mpeg2dec does not do the telecine on FILM movie (and that's better that way).
		</p>
		<p>It means that avidemux cannot tell the difference between FILM and NSTC.
		So if the mpeg looks progressive (not interlaced) and obvious desync appears (and gets worse and worse), use <c>Misc->Change fps</c> and set it to 23.976.
		</p>
		<p>For PAL mpeg, there is no problem, it is always 25 fps.
		</p>
	</ul></body>
</section>
<section>
	<title>Cropping</title>
	<body><ul>
		<p>Now you should have something like this :</p>
		<img src="../image_tuto/mpeg.png"></img>
	<p> Time to set some filters to the video. <c>F1</c> to popup the filter list.</p>
	
		<img src="../image_tuto/filters.png"></img>
		<p>
	We will select the Crop filter, to get ride of the black borders.
		If the stream is very clean, you can try the <c>autoCrop</c> button.
		On this example, the borders are very small. They appear in green for easy visual matching.

		</p>
		<img src="../image_tuto/crop.png"></img>
	</ul></body>
</section>
<section>
	<title>Resizing</title>
	<body><ul>

		<p> Now that the image has been cropped, we will resize it so something smaller.
		
		To do a correct resizing, it is very important to take the aspect ratio into account. The aspect ratio is the shape of a pixel. On a pc it is mostly square, on DVD it could be 4:3 or 16:9. So, select the input aspect ratio (16:9 is the most common for DVD) and target aspect ration (1:1 for Divx, 4:3 or 16:9 to do a DVD or SVCD). Then select the resizing method, bilinear is generally good enough for downsizing. You probably will want to check the <c>16 round up</c> to be sure the final width and height are multiples of 16. Then move the slider until you reach the desired width.
		</p>
		<p>
			<img src="../image_tuto/resizedvd.png"></img>
		</p>
	</ul></body>
</section>
<section>
	<title>More video filters</title>
	<body><ul>

		<p> Depending on the source, you may want to add more filters (subtitling, denoiser, deinterlacer...). See <uri link="video.xml.html">video filters</uri> for more.
		</p>
		<p>The video is now ready, time to set up the video encoding. You can open the preview window and move inside the movie using the slidebar, the preview window will be updated.
		</p>
	</ul></body>
</section>
</chapter>
<chapter>
	<title>Setting up the encoder</title>
<section>
	<title>Codec</title>
	<body><ul>
		<p> Obviously we want to encode the video, so we set the video to process mode (<c>F5</c>).

		</p>
		<p>Time to select a codec. My two preferred are Xvid and Lavcodec. You can use windows based tutorial for Xvid as the options are the same. For lavcodec, have a look in mplayer documentation.
		</p>		
		<p> Let's take Xvid for this mini tutorial.
		</p>
		<p><img src="../image_tuto/videocodec.png"></img>
		</p>
	</ul></body>
</section>
<section>
	<title>Configuring the codec</title>
	<body><ul>
		<p> First we will set the log file for dual pass as we may want to use it later by using <c>Misc->Select Log File</c>
		</p>
		<p>Selecting <c>Configure codec</c> will show this dialog.
		</p>
		<img src="../image_tuto/xvid.png"></img>
		<p>We will take 2pass and enter the final size.The size is the video only, you have to take the overall target size and remove the part used by the audio.
		</p>
	</ul></body>
</section>
</chapter>
<chapter>
	<title>Setting audio</title>
<section>
	<title>Internal audio</title>
	<body><ul>
		<p>If you use the audio you selected when creating the index, nothing to do. 
		</p>
	</ul></body>
</section>
<section>
	<title>External audio</title>
	<body><ul>
		<p>You can also use a external audio using <c>Audio-source</c> menu entry.
		</p>
	</ul></body>
</section>
<section>
	<title>Processing or not ?</title>
	<body><ul>
		<p>If you want to let the audio as-is, for example to do a Xvid+AC3 track do nothing and skip the whole chapter. 
		</p>
		<p>Else, set the audio to process mode and set (for example) Normalize, 48->44. To get the detail, check <uri link="audio.xml.html">audio filters</uri>
		</p>
	</ul></body>
</section>
<section>
	<title>Audio codec</title>
	<body><ul>
		<p>Same story as for video codec, select a codec, for example MP3, and configure it.		</p>
		<p>We will take 128 kbps joint stereo, like here</p>
		<img src="../image_tuto/mp3.png"></img>
	</ul></body>
</section>
</chapter>
<chapter>
	<title>Saving </title>
<section>
	<body><ul>
		<p>Now select <c>File->Save avi</c> and wait a few hours. Done.
		Avidemux will do pass 1 then pass2 and encode the audio.
		</p>
		<img src="../image_tuto/encoding.png"></img>
	</ul></body>
</section>
</chapter>
</guide>
